<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="description" content="">
        <meta name="author" content="">
        <title>PhillyFreightFinder 3.1</title>

        <!-- Core CSS -->
        <link href='lib/style.css' rel='stylesheet'/>

        <link href='http://meeroo.github.io/fonts/pff-ico.css' rel='stylesheet'/>
        <link href="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css" rel="stylesheet" type="text/css">
        <!--<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">-->
        <link href="lib/assets/typeahead.js/typeahead.js-bootstrap.css" rel="stylesheet" type="text/css"> <!--https://github.com/jharding/typeahead.js-bootstrap.css-->
        <link href="http://cdn.leafletjs.com/leaflet-0.7.1/leaflet.css" rel="stylesheet" type="text/css">

        <!-- Custom styles for this template -->
        <style>
            html, body, #sidebar, #container {
                height: 100%;
                margin: 0px;
            }
            label {
                font-weight: normal;
            }
            #loading {
                position: absolute;
                width: 220px;
                height: 19px;
                top: 50%;
                left: 50%;
                margin: -10px 0 0 -110px;
                z-index: 20001;
            }
            .table {
                margin-bottom: 0px;
            }
            .navbar-collapse.in {
                overflow-y: hidden;
            }
            .tt-dropdown-menu {
                overflow: auto;
            }
            .tt-hint, .tt-query {
                display: block;
                width: 100%;
                height: 34px;
                padding: 6px 12px;
                font-size: 14px;
                border-radius: 4px;
            }
            .typeahead-header {
                margin: 0 5px 5px 5px;
                padding: 3px 0;
                border-bottom: 1px solid #ccc;
            }
            .search-container {
                width: 250px;
            }
            #searchbox {
                -webkit-border-top-left-radius: 4px;
                -webkit-border-bottom-left-radius: 4px;
                -moz-border-top-left-radius: 4px;
                -moz-border-bottom-left-radius: 4px;
                border-top-left-radius: 4px;
                border-bottom-left-radius: 4px;
            }
            .leaflet-popup-content {
                margin-top: 5px;
                margin-bottom: 5px;
                margin-left: 5px;
                margin-right: 5px;
            }
            .leaflet-popup-content-wrapper {
                border-radius: 5px;
            }
            .navbar-inverse .navbar-nav>li>a{
            color:#BBE6FA;
            }
            .panel-heading a:hover {
                text-decoration: none;
            }
            .panel-heading{
                padding:0px 0px!important;
            }
            @media screen and (min-width: 768px) {
                .modal-dialog {
                    width:720px!important;
                }
            }

            @media (max-width: 1080px) {
                .navbar .navbar-brand {
                    font-size: 18px;
                    float: left;
                }
                .search-container {
                    width: 150px;
                }
                .leaflet-control-attribution {
                    display: none;
                }
                .dvrpc-logo{display:none;}
            }
            @media (max-width: 768px){
                .search-container {
                    width: 100%;
                }
            }
            /* Print Handling */
            @media print {
                .navbar, .toggle, #sidebar {
                    display: none !important;
                }
            }
        </style>

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.2/html5shiv.js"></script>
            <script src="//cdnjs.cloudflare.com/ajax/libs/respond.js/1.2.0/respond.js"></script>
        <![endif]-->
    </head>

    <body>
        <div class="navbar navbar-inverse navbar-fixed-top pffheader">
        <div class="navbar-header">
                <button type="button" class="navbar-toggle btn" data-toggle="collapse" data-target=".navbar-collapse" style="height: 34px; padding: 5px 10px; margin-right: 10px;"><i class="fa fa-ellipsis-v" style="color: white"></i></button>
                <button id="toggle" type="button" class="navbar-toggle btn" style="height: 34px; padding: 5px 10px; margin-right: 10px;"><i id="toggleIcon" class="fa fa-check-square-o" style="color: white"></i></button>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            <div class="navbar-brand">
                <div class="dvrpc-logo"><img src='lib/images/header_dvrpc.png' height='50'/></div>
                <div class="dvrpc-pff"><img src='lib/images/header_pff.png' height='50'/></div>
            </div>
        </div>
        <div id="navbar-links" class="navbar-collapse collapse">
             <form class="navbar-form navbar-right">
                    <div class="input-group search-container">
                        <input id="searchbox" type="text" class="form-control" placeholder="Search by facility or place name">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>
                    </div>
            </form>
            <ul class="nav navbar-nav">
                <li><a href="#" data-toggle="collapse" data-target=".navbar-collapse.in" onclick="$('#aboutModal').modal('show'); return false;"><i class="glyphicon glyphicon-info-sign" style="color: white"></i>&nbsp;&nbsp;About</a></li>
                <li><a href="#" data-toggle="collapse" data-target=".navbar-collapse.in" onclick="$('#contactModal').modal('show'); return false;"><i class="glyphicon glyphicon-question-sign" style="color: white"></i>&nbsp;&nbsp;How to Use</a></li>
               <!-- <li class="dropdown">
                    <a id="toolsDrop" href="#" role="button" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-globe" style="color: white"></i>&nbsp;&nbsp;Tools <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="#" onclick="map.fitBounds(boroughs.getBounds()); return false;"><i class="icon-fullscreen"></i>&nbsp;&nbsp;Zoom To Full Extent</a></li>
                        <li><a href="#" onclick="$('#legendModal').modal('show'); return false;"><i class="icon-picture"></i>&nbsp;&nbsp;Show Legend</a></li>
                        <li class="divider"></li>
                            <li><a href="#" onclick="$('#loginModal').modal('show'); return false;"><i class="icon-user"></i>&nbsp;&nbsp;Login</a></li>
                    </ul>
                </li>
                <li><a href="https://github.com/bmcbride/bootleaf" data-toggle="collapse" data-target=".navbar-collapse.in"><i class="icon-github-alt" style="color: white"></i>&nbsp;&nbsp;GitHub</a></li>-->
            </ul>
           
        </div><!--/.navbar-collapse -->
    </div>
    <!--Sidebar-->
       <div class="row pffcontent" id="container">
            <div class="col-sm-3 col-lg-3" id="sidebar" style="padding: 10px; overflow: auto; background-color:#bbbbbb;">

                <div class="tab-content" style="padding-top: 10px;">
                        <div class="panel-group">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <a href="#" onclick="$('#truckModal').modal('show'); return false;"><div class="PFFicon-info legicon truckinfo"> </div></a>
                                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion_" href="#Trucking-layers">
                                        <div class="panellink truckinfo">
                                            <span>Trucking/highways</span>
                                        </div>
                                    </a>
                                    <div class="togglebox"><div id="truck_all" class="uncheck" style="width:100%;height:100%;"> </div></div>
                                </div> 
                                <div id="Trucking-layers" class="panel-collapse collapse">
                                    <div class="panel-body" style="padding: 0;">
                                            <input type="hidden" id="trkChkd" value="false" /> 
                                        <div class="checkbox">
                                            <input type="checkbox" name="LayerCont" id="freeway" class="trucks" z-index="8" checked>
                                            <label class="freeway" for="freeway">Freeway</label>
                                        </div>
                                        <div class="checkbox">
                                            <input type="checkbox" name="LayerCont" id="nhsgroup" class="trucks" z-index="15" checked>
                                            <label class="NHSconn" for="nhsgroup">NHS Connector</label>
                                        </div>
                                        <div class="checkbox">
                                            <input type="checkbox" name="LayerCont" id="trkparkgroup" class="trucks" z-index="16" checked>
                                            <label class="trckpark" for="trkparkgroup">Truck Parking</label>
                                        </div>
                                        <div class="checkbox last">
                                            <input type="checkbox" name="LayerCont" id="hwyrivcrossing" class="trucks" z-index="5" checked>
                                            <label class="hwybrdg" for="hwyrivcrossing">Highway River Crossing</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                       <div class="panel-group">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <a href="#" onclick="$('#railModal').modal('show'); return false;"><div class="PFFicon-info legicon railinfo"> </div></a>
                                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion_" href="#Rail-layers">
                                        <div class="panellink railinfo">
                                            <span>Freight Rail</span>
                                        </div>
                                    </a>
                                    <div class="togglebox"><div id="rail_all" class="uncheck" style="width:100%;height:100%;"> </div></div>
                                </div>
                                <div id="Rail-layers" class="panel-collapse collapse">
                                    <div class="panel-body" style="padding: 0;">
                                        <input type="hidden" id="railChkd" value="false" /> 
                                        <div class="checkbox">
                                            <input type="checkbox" name="LayerCont" id="railines" class="rails" z-index="9" checked>
                                            <label class="raillin" for="railines">Rail Line</label>
                                        </div>
                                        <div class="checkbox">
                                            <input type="checkbox" name="LayerCont" id="railyardgroup" class="rails" z-index="5" checked>
                                            <label class="railyrd" for="railyardgroup">Rail Yard</label>
                                        </div>
                                        <div class="checkbox">
                                            <input type="checkbox" name="LayerCont" id="intermodalgroup" class="rails" z-index="4" checked>
                                            <label class="intermod" for="intermodalgroup">Intermodal Rail Yard</label>
                                        </div>
                                        <div class="checkbox">
                                            <input type="checkbox" name="LayerCont" id="gradexing" class="rails" z-index="14" checked>
                                            <label class="gradex" for="gradexing">Class I Grade Crossing</label>
                                        </div>
                                        <div class="checkbox last">
                                            <input type="checkbox" name="LayerCont" id="railbridgept" class="rails" z-index="13" checked>
                                            <label class="railbrdg" for="railbridgept">Rail River Crossing</label>
                                        </div>
                                    
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel-group">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <a href="#" onclick="$('#railModal').modal('show'); return false;"><div class="PFFicon-info legicon portinfo"> </div></a>
                                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion_" href="#port-layers">
                                        <div class="panellink portinfo">
                                            <span>Ports/waterways</span>
                                        </div>
                                    </a>
                                    <div class="togglebox"><div id="water_all" class="uncheck" style="width:100%;height:100%;"> </div></div>
                                </div>
                                <div id="port-layers" class="panel-collapse collapse">
                                    <div class="panel-body" style="padding: 0;">
                                        <input type="hidden" id="h20Chkd" value="false" /> 
                                        <div class="checkbox">
                                            <input type="checkbox" name="LayerCont" id="river" class="water" z-index="4" checked>
                                            <label class="riveric" for="river">Navigable River</label>
                                        </div>
                                        <div class="checkbox">
                                            <input type="checkbox" name="LayerCont" id="portGroup" class="water" z-index="5" checked>
                                            <label class="portic" for="portGroup">Port Terminal</label>
                                        </div>
                                        <div class="checkbox last">
                                            <input type="checkbox" name="LayerCont" id="anchorageGroup" class="water" z-index="6" checked>
                                            <label class="anchic" for="anchorageGroup">Anchorage</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--
                        <div class="panel-group">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                     <a href=""><div class="mricon-info airinfo"> </div></a>
                                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion_" href="#Air-layers">
                                        <div class="panellink airinfo">
                                            <span>Airports</span>
                                        </div>
                                    </a>
                                    <div class="togglebox"><div id="air_all" class="uncheck" style="width:100%;height:100%;"> </div></div>
                                </div>
                                <div id="Air-layers" class="panel-collapse collapse">
                                    <div class="panel-body" style="padding: 0px 15px;">
                                        <input type="hidden" id="airChkd" value="false" />
                                        <div class="checkbox">
                                            <input type="checkbox" name="LayerCont" id="commGroup" class="air" z-index="1" checked>
                                            <label class="commic" for="commGroup">Commercial</label>
                                        </div>
                                        <div class="checkbox">
                                            <input type="checkbox" name="LayerCont" id="relGroup" class="air" z-index="2" checked>
                                            <label class="relic" for="relGroup">Reliever</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel-group">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                     <a href=""><div class="mricon-info fcinfo"> </div></a>
                                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion_" href="#FC-layers">
                                        <div class="panellink fcinfo">
                                            <span>Freight Centers</span>
                                        </div>
                                    </a>
                                    <div class="togglebox"><div id="fc_all" class="uncheck" style="width:100%;height:100%;"> </div></div>
                                </div>
                                <div id="FC-layers" class="panel-collapse collapse">
                                    <div class="panel-body" style="padding: 0px 15px;">
                                        <input type="hidden" id="fcChkd" value="false" />
                                        <div class="checkbox">
                                            <input type="checkbox" name="LayerCont" id="FCmegagroup" class="fc" z-index="1" checked>
                                            <label class="megic" for="FCmegagroup">Mega Center</label>
                                        </div>
                                        <div class="checkbox">
                                            <input type="checkbox" name="LayerCont" id="FCmajorgroup" class="fc" z-index="2" checked>
                                            <label class="majic" for="FCmajorgroup">Major Center</label>
                                        </div>
                                        <div class="checkbox">
                                            <input type="checkbox" name="LayerCont" id="FCintergroup" class="fc" z-index="3" checked>
                                            <label class="interic" for="FCintergroup">Intermediate Center</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>-->
                </div>
            </div><!--Siderbar Close-->
             <!---InfoBox -->
            
            <div class="col-sm-9 col-lg-9" id="map">
                <div id="loading" style="display: block;">
                    <div class="loading-indicator">
                        <div class="progress progress-striped active">
                            <div class="progress-bar progress-bar-info" style="width: 100%"></div>
                        </div>
                    </div>
                </div>
            </div>

        </div><!--end Map and Sidebar-->
        <div class="navbar-fixed-bottom pff_footer">
            <div style='height:34px;'><!--footer-->
                <div class='footernav'>                </div>
                <div id='infobox_' class=''>
                    <div id='featureName' ></div>
                    <a href='#'><span id='togbtn' class='PFFicon-minus2 hide'></span></a><div id='iconography'></div><div id='infoheader' class='ihholder'><p>Click feature to view details</p></div>
                    
                        <div class='infowrap'>
                            <div id='info'></div>
                        </div>
                    </div>             
                </div>
        </div>  
        <div class="navbar-fixed-bottom" style='height:6px;background-color:#312867;'>e="tooltip" data-placement="right" title="Toggle sidebar"><i class="icon-chevron-left"></i></div>

        <div class="modal fade" id="aboutModal">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title">Welcome to the BootLeaf Sidebar template!</h4>
                    </div>

                    <div class="modal-body">
                         <ul id="aboutTabs" class="nav nav-tabs">
                            <li class="active"><a href="#about" data-toggle="tab"><i class="fa fa-question-circle"></i>&nbsp;About the project</a></li>
                            <li><a href="#disclaimer" data-toggle="tab"><i class="fa fa-exclamation-circle"></i>&nbsp;Disclaimer</a></li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-globe"></i>&nbsp;Metadata <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    <li><a href="#boroughs-tab" data-toggle="tab">Boroughs</a></li>
                                </ul>
                            </li>
                        </ul>
                        <div id="aboutTabsContent" class="tab-content" style="padding-top: 10px;">
                            <div class="tab-pane fade active in" id="about">
                                <p>A simple template for building web mapping applications with <a href="http://getbootstrap.com/">Bootstrap 3</a> and <a href="http://leafletjs.com/" target="_blank">Leaflet</a>.</p>
                                <div class="panel panel-primary">
                                    <div class="panel-heading">
                                        Features
                                    </div>
                                    <ul class="list-group">
                                        <li class="list-group-item">Fullscreen mobile-friendly map template with responsive navbar, sidebar, and modal placeholders</li>
                                        <li class="list-group-item">jQuery loading of external GeoJSON files</li>
                                        <li class="list-group-item">Elegant client-side multi-layer feature search with autocomplete using <a href="http://twitter.github.io/typeahead.js/" target="_blank">typeahead.js</a></li>
                                        <li class="list-group-item">Integration of Bootstrap tables into Leaflet popups</li>
                                        <li class="list-group-item">Logic for minimizing Sidebar on small screens</li>
                                        <li class="list-group-item">Custom layer control with functions for defining and retaining vector z-index when toggling layer visibility.</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="tab-pane fade text-danger" id="disclaimer">
                                <p>The data provided on this site is for informational and planning purposes only.</p>
                                <p>Absolutely no accuracy or completeness guarantee is implied or intended. All information on this map is subject to such variations and corrections as might result from a complete title search and/or accurate field survey.</p>
                            </div>
                            <div class="tab-pane fade" id="boroughs-tab">
                                <p>Borough data courtesy of <a href="http://www.nyc.gov/html/dcp/html/bytes/meta_dis_nyboroughwi.shtml" target="_blank">New York City Department of City Planning</a></p>
                            </div>
                            <div class="tab-pane fade" id="subway-lines-tab">
                                <p><a href="http://spatialityblog.com/2010/07/08/mta-gis-data-update/#datalinks" target="_blank">MTA Subway data</a> courtesy of the <a href="http://www.urbanresearch.org/about/cur-components/cuny-mapping-service" target="_blank">CUNY Mapping Service at the Center for Urban Research</a></p>
                            </div>
                            <div class="tab-pane fade" id="theaters-tab">
                                <p>Theater data courtesy of <a href="https://data.cityofnewyork.us/Recreation/Theaters/kdu2-865w" target="_blank">NYC Department of Information & Telecommunications (DoITT)</a></p>
                            </div>
                            <div class="tab-pane fade" id="museums-tab">
                                <p>Museum data courtesy of <a href="https://data.cityofnewyork.us/Recreation/Museums-and-Galleries/sat5-adpb" target="_blank">NYC Department of Information & Telecommunications (DoITT)</a></p>
                            </div>
                        </div>
                    </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->

         <!-- Trucking Modal Window -->
        <div class="modal fade" id="truckModal">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title">Trucking/Highway</h4>
                    </div>

                    <div class="modal-body">
                         <ul id="truckTabs" class="nav nav-tabs">
                            <li class="active"><a href="#trkoverview" data-toggle="tab">Overview</a></li>
                            <li><a href="#tabs-6" data-toggle="tab">Freeway</a></li>
                            <li><a href="#tabs-7" data-toggle="tab">Truck Parking</a></li>
                            <li><a href="#tabs-8" data-toggle="tab">NHS Connector</a></li>
                            <li><a href="#tabs-9" data-toggle="tab">Freeway River Crossing</a></li>
                        </ul>
                        <div id="truckTabsContent" class="tab-content" style="padding-top: 10px;">
                            <div class="tab-pane fade active in" id="trkoverview">
                                <p>Trucks are responsible for the majority of freight moved in the DVRPC region when measuring shipments by either weight or value. Additionally, the great majority of goods even if traveling by other modes, are ultimately taken by truck for final delivery to the point of sale.</p>
                                <p><i>PhillyFreightFinder</i> highlights two different types of roadways integral to trucking operations:</p>
                                <ul>
                                    <li>Freeways (including both Interstate and Limited Access Highways)</li>
                                    <li>NHS Connectors (i.e., last-mile/first-mile roads serving intermodal terminals)</li>
                                </ul>
                                <p>In addition to the roadway layers, the following point-specific locations are also provided:</p>
                                <ul>
                                    <li>Truck parking facilities</li>
                                    <li>Freeway river crossings</li>
                                </ul>
                            </div>
                            <div id="tabs-6" class="tab-pane fade in">
                                <p><img src="images/legend/truck.png" class="legicon"/>The region’s freeway system is made up of Interstate highways (both tolled and non-tolled) and limited access highways. All of these facilities are well-suited for use by commercial vehicles.</p>
                                <p>The Interstate numbering scheme designates east-west highways as even numbers and north-south highways are assigned odd numbers. The DVRPC region is served by two principal two-digit Interstate Highways, I-76 and I-95.</p>
                                <p>Auxiliary Interstate highways are circumferential, radial, or spur highways that principally serve urban areas. These types of Interstate highways are given three-digit route numbers, which consist of a single digit prefixed to the two-digit number of a nearby primary Interstate highway. There are a number of examples of three-digit auxiliary Interstate highways in the region including I-195, I-295, I-276, I-476, and I-676.</p>
                                <p>In the DVRPC region, three agencies operate tolled highways that support and complement the Interstate system. The Pennsylvania Turnpike Commission operates the Pennsylvania Turnpike and Northeast Extension. The New Jersey Turnpike Authority operates the New Jersey Turnpike and the Garden State Expressway, and the South Jersey Transportation Authority operates the Atlantic City Expressway.</p>
                                <p>Limited access highways connect collector roads to the Interstate system. U.S. highways with limited access sections in the region (i.e., one or more) include U.S. 1, 30, 202, and 422. State routes with limited access sections (i.e., one or more) include NJ 42, 55, and 90 and PA 13, 63, and 309.</p>
                                <p><i>Notes about this layer:</i><br/>
                                <i>A user may click on a freeway line at any point to display an information window with details about that particular segment of the highway. Once the information window is open, the segment of the freeway the information is related to will become highlighted in blue.</i></p>
                            </div>
                            
                            <div id="tabs-7" class="tab-pane fade in">
                                <p><img src="images/legend/parking.png" class="legicon"/>Truck parking facilities are important components of the transportation and supply chain systems. Since a very high percentage of shipments are trucked for at least some portion of the total trip, especially for final delivery, the supply and availability of well-maintained overnight parking locations are essential. The region’s truck parking facilities form an interrelated system and can be broadly categorized as follows: private truck stops, service plazas, and rest areas.</p>
                                <p>There are five private truck stops in the region. These facilities offer many amenities and services directly targeted to truck drivers. Some examples of these amenities include: restaurants, showers, laundry, truck scales, truck repair shops, and diesel fuel pumps.</p>
                                <p>There are seven service plazas in the DVRPC region along the Pennsylvania and New Jersey turnpikes. Service plazas are principally designed to accommodate passenger vehicles, but they are also outfitted with special sections set aside for truck parking. The amenities they offer to truck drivers are limited; namely, food, fuel, and bathrooms.</p>
                                <p>There are two rest areas in the DVRPC region, both on I-95 in Pennsylvania. Rest areas provide few amenities and are designed to serve as a place to take a short rest, not to stop overnight. Rest areas are relatively small in size and offer a limited number of truck parking spaces, usually fewer than ten.</p>
                                <p>For more information about the regional truck parking facilities and on the Federal Hours-of-Service regulations, please see the DVRPC publication, <i><a href="http://www.dvrpc.org/asp/pubs/publicationabstract.asp?pub_id=09057">Regional Truck Parking Study (2011)</a></i>, at the following link:<a href="http://www.dvrpc.org/asp/pubs/publicationabstract.asp?pub_id=09057">http://www.dvrpc.org/asp/pubs/publicationabstract.asp?pub_id=09057</a></p>
                                <p><i>Notes about this layer:</i><br/>
                                    <ul><li><i>Clicking on a truck parking icon in the map will activate an information window. As a user zooms in towards an individual truck parking facility, the land associated with it will also be highlighted. A user may click on the highlighted land to display the same information as clicking on the icon.</i></li></ul>   
                                </p>
                            </div>
                            
                            <div id="tabs-8" class="tab-pane fade in">
                                <p><img src="images/legend/nhs.png" class="legicon"/>To access intermodal facilities, trucks must often use connector roads from major highways. These roads, which may be either state or locally owned, are referred to as National Highway System (NHS) connectors. (Note: There are categories for NHS freight connectors and NHS transit connectors, both of which may be referred to as intermodal connectors.) By being officially designated as an NHS connector, these roadways are eligible to receive federal NHS funding for improvement projects.</p>
                                <p>While there are multiple criteria to be designated as an official NHS freight connector, the baseline metric is that the facility being served must generate 100 truck movements per day. The Delaware Valley has 11 officially designated NHS freight connectors, which total approximately 30 miles of roadways. Connectors serve three types of facilities in the Delaware Valley region: intermodal rail facility, port, and airport.</p>
                                <p>In most cases, connectors serve one specific facility, such as the Philadelphia International Airport or the Joseph Balzano Marine Terminal in Camden. A connector may also serve multiple facilities, such as in South Philadelphia where a single connector serves the Packer Avenue Marine Terminal and the CSX Greenwich Intermodal Facility. While connectors may consist of a single roadway, two or more roadways forming one connector is common because multiple roads must be used to make the full connection to the gate of the freight facility.</p>
                                <p><i>Notes about this layer:</i><br/>
                                    <ul>
                                        <li><i>When viewing the entire region on the map, the 11 NHS Freight Connectors are depicted as points represented by the NHS connector icon. When viewing a specific NHS connector at a close-in range, the road(s) that makes up the connector will appear. Clicking on any section of the NHS connector will display the same information window as the connector icon.</i></li>
                                    </ul>
                                    </p>
                            </div>
                            
                            <div id="tabs-9" class="tab-pane fade in">
                                <p><img src="images/legend/bridge2.png" class="legicon"/>While there are countless bridges in the Delaware Valley, bridges on freeways that span major rivers (i.e., the Delaware and Schuylkill Rivers) are particularly essential to Interstate commerce. In total, 13 such bridges are identified in the <i>PhillyFreightFinder</i> tool. The region’s toll bridges that serve freeways are described below.</p>
                                <p>Four prominent, tolled bridges owned by the Delaware River Port Authority (DRPA) connect Pennsylvania and New Jersey. The Walt Whitman and Ben Franklin bridges, both single-level suspension bridges, serve I-76 and I-676, respectively. The Betsy Ross Bridge is a continuous truss bridge that serves NJ 90. The Commodore Barry Bridge is a cantilever bridge that serves US 322.</p>
                                <p>The Delaware River-Turnpike Toll Bridge is an arch-shaped suspended deck truss bridge that connects the New Jersey and Pennsylvania turnpikes. The Trenton-Morrisville Toll Bridge, is a twelve-span bridge serving US 1. The Scudders Falls Bridge is a girder bridge which serves I-95. This bridge is currently free, but a major renovation project will ultimately establish tolls.</p>
                                <p><i>Notes about this layer:</i><br/>
                                    <ul>
                                        <li><i>When viewing the entire region on the map, the 13 Freeway River Crossings are depicted as points represented by the Freeway River Crossing icon. Clicking on an individual Freeway River Crossing icon will activate a corresponding information window.</i></li>
                                    </ul>
                                    </p>
                            </div>
                    </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->



        <script type="text/javascript" src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
        <script type="text/javascript" src="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="lib/assets/typeahead.js/typeahead.min.js"></script> <!--https://github.com/twitter/typeahead.js/-->
        <script type="text/javascript" src="lib/jquery.tipTip.js"></script> 
        <script type="text/javascript" src="lib/jquery.checkall.js"></script>
        <!--<script type="text/javascript" src="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.js"></script>-->
        <script type="text/javascript" src="http://cdn.leafletjs.com/leaflet-0.7.1/leaflet.js?2"></script>
        <script type="text/javascript" src="lib/DVRPC_control/L.Base.Control.js"></script>
        <script type="text/javascript" src="lib/layers.js"></script>
        <!--<script src="leaflet-providers.js"></script>-->
        <script src="lib/leaflet.viewcenter.js"></script>
        <script type="text/javascript" src="lib/PFFactions.js"></script>
        <script type="text/javascript">
            //establish map and search groups
            var map, countySearch = [], highwaySearch = [], truckParkSearch = [], nhsSearch = [], hwyBridgeSearch = [], railSearch = [], railyardSearch = [], intermodalSearch = [], RailBridgeSearch = [], xingSearch = [], riverSearch =[], portSearch =[], anchSearch = []; 

            $(document).ready(function() {
                $('[rel=tooltip]').tooltip();
                if (document.body.clientWidth <= 767) {
                    $('#sidebar').toggle();
                    $('a.toggle i').toggleClass('icon-chevron-left icon-chevron-right');
                };
            });
            $(window).resize(function() {
                $(".tt-dropdown-menu").css("max-height", $("#container").height()-$(".navbar").height()-20);
                if (document.body.clientWidth <= 767) {
                    $("#map").css("class", "col-sm-12 col-lg-12");
                    $("#sidebar").css("display", "none");
                } else {
                    $("#map").css("class", "col-sm-9 col-lg-9");
                    $("#sidebar").css("display", "block");
                };
            });

           $('a.toggle').click(function() {
                $('a.toggle i').toggleClass('icon-chevron-left icon-chevron-right');
                $('#map').toggleClass('col-sm-9 col-lg-9 col-sm-12 col-lg-12');
                $('#sidebar').toggle();
                map.invalidateSize();
                return false;
            });

           ///LayerControls Expanded/////////////////////////

            $('input:checkbox[name="LayerCont"]').on('change', function () {
                var layers = [];
                function sortByKey(array, key) {
                    return array.sort(function (a, b) {
                        var x = a[key];
                        var y = b[key];
                        return ((x < y) ? -1 : ((x > y) ? 1 : 0));
                    });
                }
                if ($('#' + $(this).attr('id')).is(':checked')) {
                    $('input:checkbox[name="LayerCont"]').each(function () {
                        // Remove all overlay layers
                        map.removeLayer(window[$(this).attr('id')]);
                        if ($('#' + $(this).attr('id')).is(':checked')) {
                            // Add checked layers to array for sorting
                            layers.push({
                                'z-index': $(this).attr('z-index'),
                                'layer': $(this)
                            });
                        }
                    });
                    // Sort layers array by z-index
                    var orderedLayers = sortByKey(layers, 'z-index');
                    // Loop through ordered layers array and add to map in correct order
                    $.each(orderedLayers, function () {
                        map.addLayer(window[$(this)[0].layer[0].id]);
                    });
                } else {
                    // Simply remove unchecked layers
                    map.removeLayer(window[$(this).attr('id')]);
                }
            }); 

            // Basemap Layers
           var Esri_WorldImagery = L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
            });

           //load map
            map = L.map("map", {
                minZoom: 9,
                zoomControl:false,
                layers: [Esri_WorldImagery]
            });

            // Data Layers
            //define highway layers      
            //define truck parking polygons
                var truckparkpoly = L.geoJson(null, {
                        style: {fillColor: "#884C9E", fillOpacity:.50, weight:1, color:"#E0E0E0 ", opacity:.75},    
                        onEachFeature: function (feature, layer){
                            layer.on({
                                click: highlighttruckparkingpoly,
                                dblclick: zoomToFeature
                            });
                            truckParkSearch.push({
                                value: layer.feature.properties.Name,
                                tokens: [layer.feature.properties.Name],
                                layer: "TruckParking",
                                id: L.stamp(layer),
                                bounds: layer.getBounds()
                            });
                        }
                });
                $.getJSON("data/truckparkPoly.geojson", function (data) {
                truckparkpoly.addData(data);
                });
            //define truck parking points  
                var trckprkicon = L.icon({
                            iconUrl: 'lib/images/parking.png',
                            iconSize: [30, 30],
                            iconAnchor: [15, 15],
                            popupAnchor: [0, 15]
                    });
                var tppoints = L.geoJson(null, {
                        pointToLayer: function (feature, latlng) {
                            return L.marker(latlng, {icon: trckprkicon});
                            },
                        onEachFeature: function (feature, layer){
                            layer.on({
                                click: highlighttruckparking,
                                dblclick: zoomToPoint
                            });
                            }
                });  
                $.getJSON("data/truckparkPts.geojson", function (data) {
                tppoints.addData(data);
                });
            //define hwy bridge icons
                var hwybricon = L.icon({
                            iconUrl: 'lib/images/bridge2.png',
                            iconSize: [30, 30],
                            iconAnchor: [15, 15],
                            popupAnchor: [0, 15]
                    });
                var hwyrivcrossing = L.geoJson(null, {
                        pointToLayer: function (feature, latlng) {
                            return L.marker(latlng, {icon: hwybricon});
                            },
                        onEachFeature: function (feature, layer){
                            layer.on({
                                click: highlighthwyrivcrossing,
                                dblclick: zoomToPoint
                            });
                        hwyBridgeSearch.push({
                                value: layer.feature.properties.Name_1,
                                tokens: [layer.feature.properties.Name_1],
                                layer: "HwyBridges",
                                id: L.stamp(layer),
                                lat: layer.feature.geometry.coordinates[1],
                                lng: layer.feature.geometry.coordinates[0]
                            });
                            }
                })
                $.getJSON("data/hwybrdgPts.geojson", function (data) {
                hwyrivcrossing.addData(data);
                });
            //define NHS polylines
                var nhspoly = L.geoJson(null, {
                        style: {weight:5, color:"#E8C3F5 ", opacity:1}, 
                        onEachFeature: function (feature, layer){
                            layer.on({
                                click: highlightNHSpoly,
                                dblclick: zoomToFeature
                            });
                            nhsSearch.push({
                                value: layer.feature.properties.Name_1,
                                tokens: [layer.feature.properties.Name_1],
                                layer: "NHS",
                                id: L.stamp(layer),
                                bounds: layer.getBounds()
                            });
                        }
                });
                $.getJSON("data/nhsPoly.geojson", function (data) {
                nhspoly.addData(data);
                });
            //define NHS points
                var NHSicon = L.icon({
                            iconUrl: 'lib/images/nhs.png',
                            iconSize: [30, 30],
                            iconAnchor: [15, 15],
                            popupAnchor: [0, 15]
                    });
                var nhs = L.geoJson(null, {
                        pointToLayer: function (feature, latlng) {
                            return L.marker(latlng, {icon: NHSicon});
                            },
                        onEachFeature: function (feature, layer){
                            layer.on({
                                click: highlightNHS,
                                dblclick: zoomToPoint
                            });
                            }
                });
                $.getJSON("data/nhsPts.geojson", function (data) {
                nhs.addData(data);
                });
            //define freeways
                var freeway = L.geoJson(null, {
                     style: function style(feature) {
                        switch (feature.properties.Type) {
                            case 'Limited Access Highway': return {color: "#C57AE0",weight:5, opacity:1};
                            case 'Interstate Highway': return {color: "#884C9E",weight:5, opacity:1};
                        }   
                    },
                    onEachFeature: function (feature, layer){
                        layer.on({
                            click: highlightfreeways,
                            dblclick: zoomToFeature
                        });
                        highwaySearch.push({
                            value: layer.feature.properties.Name,
                            tokens: [layer.feature.properties.Name],
                            layer: "Highways",
                            id: L.stamp(layer),
                            bounds: layer.getBounds()
                        });
                    }

                });
                 $.getJSON("data/highways.geojson", function (data) {
                    freeway.addData(data);
                });
            //define rail layers
            //define rail lines
            var railines = L.geoJson(null, {
                style: function style(feature) {
                    switch (feature.properties.Type) {
                        case 'Industrial Track \/ Shortline': return {color: "#FEEDDE",weight:5, opacity:.90};
                        case 'Secondary': return {color: "#FDCC8A",weight:5, opacity:.90};
                        case 'Interstate': return {color: "#FD8D3C",weight:5, opacity:.90};
                    }   
                },
                onEachFeature: function (feature, layer){
                    layer.on({
                        click: highlightraillines,
                        dblclick: zoomToFeature
                    });
                    railSearch.push({
                            value: layer.feature.properties.Name,
                            tokens: [layer.feature.properties.Name],
                            layer: "RailLines",
                            id: L.stamp(layer),
                            bounds: layer.getBounds()
                        });
                }
            });
            $.getJSON("data/freightrail.geojson", function (data) {
                    railines.addData(data);
                });
            //define rail yards
            var railyardpoly = L.geoJson(null, {
                style: {fillColor: "#FBA919", fillOpacity:.50, weight:1, color:"#E0E0E0 ", opacity:.75},    
                onEachFeature: function (feature, layer){
                    layer.on({
                        click: highlightrailyardspoly,
                        dblclick: zoomToFeature
                    });
                     railyardSearch.push({
                            value: layer.feature.properties.Name,
                            tokens: [layer.feature.properties.Name],
                            layer: "RailYards",
                            id: L.stamp(layer),
                            bounds: layer.getBounds()
                        });
                }
            });
            $.getJSON("data/railyardPoly.geojson", function (data) {
                railyardpoly.addData(data);
            });
            var ryicon = L.icon({
                            iconUrl: 'lib/images/railyard.png',
                            iconSize: [30, 30],
                            iconAnchor: [15, 15],
                            popupAnchor: [0, 15]
                    });
            var railyardpt = L.geoJson(null, {
                pointToLayer: function (feature, latlng) {
                    return L.marker(latlng, {icon: ryicon});
                    },
                onEachFeature: function (feature, layer){
                    layer.on({
                        click: highlightrailyardpt,
                        dblclick: zoomToPoint
                    });
                    }
            });
            $.getJSON("data/railyardPts.geojson", function (data) {
                railyardpt.addData(data);
            });
                //define intermodal
                var intermodalpoly = L.geoJson(null, {
                    style: {fillColor: "#FBA919", fillOpacity:.50, weight:1, color:"#E0E0E0 ", opacity:.75},    
                    onEachFeature: function (feature, layer){
                        layer.on({
                            click: highlightrailintermodalpoly,
                            dblclick: zoomToFeature
                        });
                        intermodalSearch.push({
                            value: layer.feature.properties.Name_1,
                            tokens: [layer.feature.properties.Name_1],
                            layer: "Intermodal",
                            id: L.stamp(layer),
                            bounds: layer.getBounds()
                        });
                    }
                }); 
                $.getJSON("data/intermodalPoly.geojson", function (data) {
                    intermodalpoly.addData(data);
                });
                var imicon = L.icon({
                    iconUrl: 'lib/images/intermodal.png',
                    iconSize: [30, 30],
                    iconAnchor: [15, 15],
                    popupAnchor: [0, 15]
                });
                var intermodalpt = L.geoJson(null, {
                        pointToLayer: function (feature, latlng) {
                            return L.marker(latlng, {icon: imicon});
                            },
                        onEachFeature: function (feature, layer){
                            layer.on({
                                click: highlightrailintermodal,
                                dblclick: zoomToPoint
                            });
                            }
                });
                 $.getJSON("data/intermodalPts.geojson", function (data) {
                    intermodalpt.addData(data);
                });
                //define grade crossings
                var xingicon = L.icon({
                        iconUrl: 'lib/images/gradecrossing.png',
                        iconSize: [30, 30],
                        iconAnchor: [15, 15],
                        popupAnchor: [0, 15]
                });
                var gradexing = L.geoJson(null, {
                            pointToLayer: function (feature, latlng) {
                                return L.marker(latlng, {icon: xingicon});
                                },
                            onEachFeature: function (feature, layer){
                                layer.on({
                                    click: highlightrailcrossings,
                                    dblclick: zoomToPoint
                                });
                                xingSearch.push({
                                    value: layer.feature.properties.Name,
                                    tokens: [layer.feature.properties.Name, layer.feature.properties.CROSSING_1],
                                    layer: "GradeCrossing",
                                    id: L.stamp(layer),
                                    lat: layer.feature.geometry.coordinates[1],
                                    lng: layer.feature.geometry.coordinates[0]
                                });
                                }
                });
                $.getJSON("data/gradeXing.geojson", function (data) {
                    gradexing.addData(data);
                });
                //define rail bridge
                var rbicon = L.icon({
                            iconUrl: 'lib/images/bridge1.png',
                            iconSize: [30, 30],
                            iconAnchor: [15, 15],
                            popupAnchor: [0, 15]
                    });
                var railbridgept = L.geoJson(null, {
                                pointToLayer: function (feature, latlng) {
                                    return L.marker(latlng, {icon: rbicon});
                                    },
                                onEachFeature: function (feature, layer){
                                    layer.on({
                                        click: highlightrailrivcrossing,
                                        dblclick: zoomToPoint
                                    });
                                    RailBridgeSearch.push({
                                        value: layer.feature.properties.Name,
                                        tokens: [layer.feature.properties.Name],
                                        layer: "RailBridges",
                                        id: L.stamp(layer),
                                        lat: layer.feature.geometry.coordinates[1],
                                        lng: layer.feature.geometry.coordinates[0]
                                    });
                                    }
                });
                $.getJSON("data/railbrdgPts.geojson", function (data) {
                    railbridgept.addData(data);
                });
                //define maritime facilities
                //define river
                var river = L.geoJson(null, {
                    style: {fillColor: "#55B8DF", fillOpacity:.50, weight:1, color:"#E0E0E0 ", opacity:.65},    
                    onEachFeature: function (feature, layer){
                        layer.on({
                            click: highlightriver,
                            dblclick: zoomToFeature
                        });
                        riverSearch.push({
                                value: layer.feature.properties.NAME,
                                tokens: [layer.feature.properties.NAME],
                                layer: "Rivers",
                                id: L.stamp(layer),
                                bounds: layer.getBounds()
                            });
                    }
                });
                $.getJSON("data/river.geojson", function (data) {
                    river.addData(data);
                });
                //define ports
                var portpoly = L.geoJson(null, {
                    style: {fillColor: "#29A0CF", fillOpacity:.50, weight:1, color:"#E0E0E0 ", opacity:.75},    
                    onEachFeature: function (feature, layer){
                        layer.on({
                            click: highlightportpoly,
                            dblclick: zoomToFeature
                        });
                        portSearch.push({
                            value: layer.feature.properties.Name,
                            tokens: [layer.feature.properties.Name],
                            layer: "PortTerminals",
                            id: L.stamp(layer),
                            bounds: layer.getBounds()
                        });
                    }
                });
                $.getJSON("data/portsPoly.geojson", function (data) {
                    portpoly.addData(data);
                });
                var prticon = L.icon({
                    iconUrl: 'lib/images/ports.png',
                    iconSize: [30, 30],
                    iconAnchor: [15, 15],
                    popupAnchor: [0, 15]
                });
                var porticon = L.geoJson(null, {
                        pointToLayer: function (feature, latlng) {
                            return L.marker(latlng, {icon: prticon});
                            },
                        onEachFeature: function (feature, layer){
                            layer.on({
                                click: highlightporticon,
                                dblclick: zoomToPoint
                            });
                            }
                }); 
                $.getJSON("data/portsPts.geojson", function (data) {
                    porticon.addData(data);
                });
                //define anchorages
                var anchoragepoly = L.geoJson(null, {
                    style: {fillColor: "#0E76BC", fillOpacity:.50, weight:1, color:"#E0E0E0 ", opacity:.65},    
                    onEachFeature: function (feature, layer){
                        layer.on({
                            click: highlightanchoragepoly,
                            dblclick: zoomToFeature
                        });
                        anchSearch.push({
                            value: layer.feature.properties.Name,
                            tokens: [layer.feature.properties.Name],
                            layer: "Anchorages",
                            id: L.stamp(layer),
                            bounds: layer.getBounds()
                        });
                    }
                });
                $.getJSON("data/anchPoly.geojson", function (data) {
                    anchoragepoly.addData(data);
                });
                var anchicon = L.icon({
                    iconUrl: 'lib/images/anchor.png',
                    iconSize: [30, 30],
                    iconAnchor: [15, 15],
                    popupAnchor: [0, 15]
                    });
                var anchoricon = L.geoJson(null, {
                        pointToLayer: function (feature, latlng) {
                            return L.marker(latlng, {icon: anchicon});
                            },
                        onEachFeature: function (feature, layer){
                            layer.on({
                                click: highlightanchoricon,
                                dblclick: zoomToPoint
                            });
                            }
                });
                $.getJSON("data/anchPts.geojson", function (data) {
                    anchoricon.addData(data);
                });



            // Static DVRPC Layers
            var counties = L.geoJson(null, {
                style: function (feature) {
                    return {
                        color: "white",
                        fill: false,
                        opacity: 0.6,
                        clickable: false,
                    };
                },
                onEachFeature: function (feature, layer) {
                    countySearch.push({
                        value: layer.feature.properties.Co_Name,
                        tokens: [layer.feature.properties.Co_Name],
                        layer: "Counties",
                        id: L.stamp(layer),
                        bounds: layer.getBounds()
                    });
                }
            });
            $.getJSON("data/counties.geojson", function (data) {
                counties.addData(data);
            }).complete(function () {
                map.fitBounds(counties.getBounds());
            });           


            
            //map.setMaxBounds(counties.getBounds());
            //add layers in groups by order

            (counties).setZIndex(0).addTo(map);
            map.addLayer(river);
            var railyardgroup = new L.FeatureGroup([railyardpt, railyardpoly]).addTo(map);
            var intermodalgroup = new L.FeatureGroup([intermodalpt, intermodalpoly]).addTo(map);
            var Rail = {
                "Rail Line": railines,
                "Rail Yard": railyardgroup,
                "Intermodal Yard": intermodalgroup,
                "Class I Grade Crossing": gradexing,
                "Rail River Crossing": railbridgept
            };
            var portGroup = new L.FeatureGroup([porticon, portpoly]).addTo(map);
            var anchorageGroup = new L.FeatureGroup([anchoricon, anchoragepoly]).addTo(map);
            var Portwater = {
                "Navigable River": river,
                "Port Terminal": portGroup,
                "Anchorage": anchorageGroup
            };
            var nhsgroup =new L.FeatureGroup([nhspoly, nhs]).addTo(map);
            var trkparkgroup =new L.FeatureGroup([truckparkpoly, tppoints]).addTo(map);
            var Highway = {
                "Freeway": freeway,
                "NHS Connector": nhsgroup,
                "Truck Parking": trkparkgroup,
                "Highway River Crossing": hwyrivcrossing  
            };
            (hwyrivcrossing).addTo(map);
            (railines).addTo(map);
            map.addLayer(freeway);
            map.addLayer(gradexing);
            map.addLayer(railbridgept);
//            (freeway).addTo(map); 


            //add additional map controls
            var viewCenter = new L.Control.ViewCenter();
            map.addControl(viewCenter);

            var zoomcontrol = new L.Control.Zoom();
            map.addControl(zoomcontrol);
          
            </script>
            <script type="text/javascript">

            // Clear the tooltip and clear highlights when map is clicked       
            $("#map").click(function(){
                    resetHighlight();
                    $('#togbtn').addClass('hide');
                    $('#infobox_').removeClass('active').css('bottom',6);
                    document.getElementById('featureName').innerHTML = '';
                    document.getElementById('infoheader').innerHTML = '<p>Click feature to view details</p>';
                    document.getElementById('infoheader').className = '';
                    document.getElementById('featureName').className = '';
                    document.getElementById('iconography').className = '';
                    document.getElementById('info').innerHTML = '';
            });
            /*

            $( document ).ready(function() {
                map.on('click',function(e){
                    resetHighlight();
                    $('#togbtn').addClass('hide');
                    $('#infobox_').removeClass('active').css('bottom',6);
                    document.getElementById('featureName').innerHTML = '';
                    document.getElementById('infoheader').innerHTML = '<p>Click feature to view details</p>';
                    document.getElementById('infoheader').className = '';
                    document.getElementById('featureName').className = '';
                    document.getElementById('iconography').className = '';
                    document.getElementById('info').innerHTML = '';

                    
                });
            });*/
            //toggle infobox
            function toggleinfo(e){
                    if($('#togbtn').hasClass('hide')){
                        $('#togbtn').removeClass('hide');
                    };
                    if($('#togbtn').hasClass('PFFicon-plus2')){
                            $('#togbtn').toggleClass('PFFicon-plus2');
                    }else{        
                    };
                    var h = document.getElementById('info').offsetHeight+34;
                    $('#infobox_').addClass('active').css('bottom',h);
            };

            function togglemin(e){
                    if($('#togbtn').hasClass('PFFicon-plus2')){

                    }else{
                        $('#togbtn').toggleClass('PFFicon-plus2');
                    };
                    $('#infobox_').css('bottom',6).removeClass('active');                        
            };

            $(".PFFicon-minus2").click(function(){
                if($('#infobox_').hasClass('active')){
                    togglemin();
                }else{
                    toggleinfo();
                };
              });


            //   Search Functionality  ///////

            // Highlight search box text on click
            $("#searchbox").click(function () {
                $(this).select();
            });

            // Typeahead search functionality
            $(document).one("ajaxStop", function() {
                $("#loading").hide();
                $("#searchbox").typeahead([{
                    name: "Counties",
                    local: countySearch,
                    minLength: 2,
                    header: "<h5 class='typeahead-header'>County</h5>"
                },{
                    name: "Highways",
                    local: highwaySearch,
                    minLength: 2,
                    header: "<h5 class='typeahead-header'><img src='lib/images/flat/truck.png' class='searchico'>Highways</h5>"
                },{
                    name: "NHS",
                    local: nhsSearch,
                    minLength: 2,
                    header: "<h5 class='typeahead-header'><img src='lib/images/flat/nhs.png' class='searchico'>NHS Connectors</h5>"
                },{
                    name: "TruckParking",
                    local: truckParkSearch,
                    minLength: 2,
                    header: "<h5 class='typeahead-header'><img src='lib/images/flat/parking.png' class='searchico'>Truck Parking</h5>"
                },{
                    name: "HwyBridges",
                    local: hwyBridgeSearch,
                    minLength: 2,
                    header: "<h5 class='typeahead-header'><img src='lib/images/flat/bridge2.png' class='searchico'>Highway River Crossings</h5>"
                },{
                    name: "RailLines",
                    local: railSearch,
                    minLength: 2,
                    header: "<h5 class='typeahead-header'><img src='lib/images/flat/train.png' class='searchico'>Rail Lines</h5>"
                },{
                    name: "RailYards",
                    local: railyardSearch,
                    minLength: 2,
                    header: "<h5 class='typeahead-header'><img src='lib/images/flat/railyard.png' class='searchico'>Rail Yards</h5>"
                },{
                    name: "Intermodal",
                    local: intermodalSearch,
                    minLength: 2,
                    header: "<h5 class='typeahead-header'><img src='lib/images/flat/intermodal.png' class='searchico'>Intermodal Rail Yards</h5>"
                },{
                    name: "GradeCrossing",
                    local: xingSearch,
                    minLength: 2,
                    header: "<h5 class='typeahead-header'><img src='lib/images/flat/gradecrossing.png' class='searchico'>Grade Crossings</h5>"
                },{
                    name: "RailBridges",
                    local: RailBridgeSearch,
                    minLength: 2,
                    header: "<h5 class='typeahead-header'><img src='lib/images/flat/bridge1.png' class='searchico'>Rail River Crossing</h5>"
                },{
                    name: "Rivers",
                    local: riverSearch,
                    minLength: 2,
                    header: "<h5 class='typeahead-header'><img src='lib/images/flat/river.png' class='searchico'>River Channels</h5>"
                },{
                    name: "PortTerminals",
                    local: portSearch,
                    minLength: 2,
                    header: "<h5 class='typeahead-header'><img src='lib/images/flat/ports.png' class='searchico'>Port Terminals</h5>"
                },{
                    name: "Anchorages",
                    local: anchSearch,
                    minLength: 2,
                    header: "<h5 class='typeahead-header'><img src='lib/images/flat/anchor.png' class='searchico'>Anchorages</h5>"
                },{
                    name: "GeoNames",
                    remote: {
                        url: "http://ws.geonames.org/searchJSON?featureClass=P&maxRows=5&countryCode=US&name_startsWith=%QUERY",
                        beforeSend: function(jqXhr, settings) {
                            settings.url += "&east="+counties.getBounds().getEast()+"&west="+counties.getBounds().getWest()+"&north="+counties.getBounds().getNorth()+"&south="+counties.getBounds().getSouth();
                        },
                        filter: function(parsedResponse) {
                            var dataset = [];
                            for(i = 0; i < parsedResponse.geonames.length; i++) {
                                dataset.push({
                                    value: parsedResponse.geonames[i].name,
                                    tokens: [parsedResponse.geonames[i].name],
                                    layer: "GeoNames",
                                    lat: parsedResponse.geonames[i].lat,
                                    lng: parsedResponse.geonames[i].lng
                                });
                            }
                            return dataset;
                        }
                    },
                    minLength: 2,
                    limit: 5,
                    header: "<h5 class='typeahead-header'>Location</h5>"
                  }]).on("typeahead:selected", function (obj, datum) {
                    if (datum.layer === "Counties") {
                        map.fitBounds(datum.bounds);
                    };
                    if (datum.layer === "Highways") {
                        if (!map.hasLayer(freeway)) {
                            map.addLayer(freeway);
                            $("#freeway").prop("checked", true);
                        };
                        map.fitBounds(datum.bounds);
                        if (map._layers[datum.id]) {
                            highlightfreeways(map._layers[datum.id]);
                        }; 
                    };
                    if (datum.layer === "NHS") {
                        if (!map.hasLayer(nhsgroup)) {
                            map.addLayer(nhsgroup);
                            $("#nhsgroup").prop("checked", true);
                        };
                        map.fitBounds(datum.bounds);
                        if (map._layers[datum.id]) {
                            highlightNHSpoly(map._layers[datum.id]);
                        }; 
                    };
                    if (datum.layer === "TruckParking") {
                        if (!map.hasLayer(trkparkgroup)) {
                            map.addLayer(trkparkgroup);
                            $("#trkparkgroup").prop("checked", true);
                        };
                        map.fitBounds(datum.bounds);
                        if (map._layers[datum.id]) {
                            highlighttruckparkingpoly(map._layers[datum.id]);
                        }; 
                    };
                    if (datum.layer === "HwyBridges") {
                        if (!map.hasLayer(hwyrivcrossing)) {
                            map.addLayer(hwyrivcrossing);
                            $("#hwyrivcrossing").prop("checked", true);
                        };
                        map.setView([datum.lat, datum.lng], 17);
                        if (map._layers[datum.id]) {
                            highlighthwyrivcrossing(map._layers[datum.id]);
                        }; 
                    };
                    if (datum.layer === "RailLines") {
                        if (!map.hasLayer(railines)) {
                            map.addLayer(railines);
                            $("#railines").prop("checked", true);
                        };
                        map.fitBounds(datum.bounds);
                        if (map._layers[datum.id]) {
                            highlightraillines(map._layers[datum.id]);
                        }; 
                    };
                    if (datum.layer === "RailYards") {
                        if (!map.hasLayer(railyardgroup)) {
                            map.addLayer(railyardgroup);
                            $("#railyardgroup").prop("checked", true);
                        };
                        map.fitBounds(datum.bounds);
                        if (map._layers[datum.id]) {
                            highlightrailyardspoly(map._layers[datum.id]);
                        }; 
                    };
                    if (datum.layer === "Intermodal") {
                        if (!map.hasLayer(intermodalgroup)) {
                            map.addLayer(intermodalgroup);
                            $("#intermodalgroup").prop("checked", true);
                        };
                        map.fitBounds(datum.bounds);
                        if (map._layers[datum.id]) {
                            highlightrailintermodalpoly(map._layers[datum.id]);
                        }; 
                    };
                    if (datum.layer === "GradeCrossing") {
                        if (!map.hasLayer(gradexing)) {
                            map.addLayer(gradexing);
                            $("#gradexing").prop("checked", true);
                        };
                        map.setView([datum.lat, datum.lng], 17);
                        if (map._layers[datum.id]) {
                            highlightrailcrossings(map._layers[datum.id]);
                        }; 
                    };
                    if (datum.layer === "RailBridges") {
                        if (!map.hasLayer(railbridgept)) {
                            map.addLayer(railbridgept);
                            $("#railbridgept").prop("checked", true);
                        };
                        map.setView([datum.lat, datum.lng], 17);
                        if (map._layers[datum.id]) {
                            highlightrailrivcrossing(map._layers[datum.id]);
                        }; 
                    };
                    if (datum.layer === "Rivers") {
                        if (!map.hasLayer(river)) {
                            map.addLayer(river);
                            $("#river").prop("checked", true);
                        };
                        map.fitBounds(datum.bounds);
                        if (map._layers[datum.id]) {
                            highlightriver(map._layers[datum.id]);
                        }; 
                    };
                    if (datum.layer === "PortTerminals") {
                        if (!map.hasLayer(portGroup)) {
                            map.addLayer(portGroup);
                            $("#portGroup").prop("checked", true);
                        };
                        map.fitBounds(datum.bounds);
                        if (map._layers[datum.id]) {
                            highlightportpoly(map._layers[datum.id]);
                        }; 
                    };
                    if (datum.layer === "Anchorages") {
                        if (!map.hasLayer(anchorageGroup)) {
                            map.addLayer(anchorageGroup);
                            $("#anchorageGroup").prop("checked", true);
                        };
                        map.fitBounds(datum.bounds);
                        if (map._layers[datum.id]) {
                            highlightanchoragepoly(map._layers[datum.id]);
                        }; 
                    };
                    if (datum.layer === "GeoNames") {
                        map.setView([datum.lat, datum.lng], 14);
                    };
                    if ($("#navbar-collapse").height() > 50) {
                        $("#navbar-collapse").collapse("hide");
                    };
                }).on("typeahead:initialized ", function () {
                    $(".tt-dropdown-menu").css("max-height", 300);
                }).on("typeahead:opened", function () {
                    $(".navbar-collapse.in").css("max-height", $(document).height()-$(".navbar-header").height());
                    $(".navbar-collapse.in").css("height", $(document).height()-$(".navbar-header").height());
                }).on("typeahead:closed", function () {
                    $(".navbar-collapse.in").css("max-height", "");
                    $(".navbar-collapse.in").css("height", "");
                });
            });

            // Placeholder hack for IE
            if (navigator.appName == "Microsoft Internet Explorer") {
                $("input").each( function () {
                    if ($(this).val() == "" && $(this).attr("placeholder") != "") {
                        $(this).val($(this).attr("placeholder"));
                        $(this).focus(function () {
                            if ($(this).val() == $(this).attr("placeholder")) $(this).val("");
                        });
                        $(this).blur(function () {
                            if ($(this).val() == "") $(this).val($(this).attr("placeholder"));
                        });
                    }
                });
            }
        </script>
    </body>
</html>